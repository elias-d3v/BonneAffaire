{% extends 'base.html.twig' %}

{% block body %}
<section class="admin-dashboard">
  <h1>Tableau de bord admin</h1>

  <div class="admin-grid">
    
    {# Liste des utilisateurs #}
    <div class="admin-card">
      <h2>Utilisateurs</h2>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Email</th>
            <th>Nom</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for user in users %}
            <tr>
              <td>{{ user.id }}</td>
              <td>{{ user.email }}</td>
              <td>{{ user.name }}</td>
              <td>
                <a href="{{ path('admin_user_delete', {id: user.id}) }}" class="btn-danger">Supprimer</a>
              </td>
            </tr>
          {% else %}
            <tr><td colspan="4">Aucun utilisateur</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    {# Liste des annonces en attente de validation #}
    <div class="admin-card">
      <h2>Annonces en attende</h2>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Titre</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for post in posts %}
            {% if post.status != "validated" %}
                <tr>
                    <td>{{ post.id }}</td>
                    <td>{{ post.title }}</td>
                    <td>{{ post.status }}</td>
                    <td>
                      <div class="actions">
                        <a href="{{ path('admin_post_validate', {id: post.id}) }}" class="btn-success">Valider</a>
                        <a href="{{ path('admin_post_delete', {id: post.id}) }}" class="btn-danger">Supprimer</a>
                      </div>
                    </td>
                </tr>
            {% endif %}
          {% else %}
            <tr><td colspan="4">Aucune annonce</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    {# Liste des signalements #}
    <div class="admin-card">
      <h2>Signalements</h2>
      <table>
        <thead>
          <tr>
            <th>ID</th>
            <th>Auteur de l'annonce</th>
            <th>Auteur signalement</th>
            <th>Annonce</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
        {% for report in reports %}
            {% if not report.isHandled %}
            <tr>
                <td>{{ report.id }}</td>

                {# Auteur de lâ€™annonce signalÃ©e #}
                <td>
                  <a href="{{ path('app_profile_show', {id: report.author.id}) }}" class="link">
                      {{ report.author.name }}
                  </a>
                </td>

                {# Utilisateur qui a signalÃ© #}
                <td>
                  <a href="{{ path('app_profile_show', {id: report.reporter.id}) }} " class="link">
                      {{ report.reporter.name }}
                  </a>
                </td>

                {# Lâ€™annonce concernÃ©e #}
                <td>
                  <a href="{{ path('post_show', {id: report.post.id}) }}" class="link">
                      {{ report.post.title }}
                  </a>
                </td>

                <td>
                  <a href="{{ path('admin_report_handle', {id: report.id}) }}" class="btn btn-success">Taiter</a>
                </td>
            </tr>
            {% endif %}
        {% else %}
            <tr>
            <td colspan="5">Aucun signalement en attente ðŸš€</td>
            </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</section>
{% endblock %}
