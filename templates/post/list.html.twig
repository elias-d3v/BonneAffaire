{% extends 'base.html.twig' %}

{% block body %}
<h1>Liste des annonces</h1>

{% for post in posts %}
  <div class="card" style="margin-bottom: 20px; padding: 10px; border: 1px solid #ccc;">
    <h2>
      <a href="{{ path('post_show', {id: post.id}) }}">
        {{ post.title }}
      </a>
    </h2>
    <p>Prix : {{ post.price }} €</p>
    <p>Lieu : {{ post.location }} - {{ post.postalCode }}</p>
    <p>Catégorie : {{ post.category.name }}</p>
    <p>Publié par {{ post.user.name }}</p>

    {# Images #}
    {% if post.image1 %}
      <img src="{{ asset('uploads/' ~ post.image1) }}" width="150">
    {% endif %}
    {% if post.image2 %}
      <img src="{{ asset('uploads/' ~ post.image2) }}" width="150">
    {% endif %}
    {% if post.image3 %}
      <img src="{{ asset('uploads/' ~ post.image3) }}" width="150">
    {% endif %}

    {% if app.user and (app.user == post.user or 'ROLE_ADMIN' in app.user.roles) %}
    <a href="{{ path('post_edit', {id: post.id}) }}">Modifier l’annonce</a>
    {% endif %}
  </div>
  
{% else %}
  <p>Aucune annonce disponible.</p>
{% endfor %}
{% endblock %}
